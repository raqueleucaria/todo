<%= turbo_stream.remove dom_id(@task) %>

<% if @task.parent_id.nil? && Task.where(parent_id: nil).count == 0 %>
  <%= turbo_stream.update "empty_state" do %>
    <%= render "empty_state" %>
  <% end %>
<% end %>

<% if @task.parent_id.present? %>
  <%= turbo_stream.replace dom_id(@task.parent) do %>
    <%= render "task", task: @task.parent.reload %>
  <% end %>
<% end %>

<%= turbo_stream.update "notice" do %>
  <div class="fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300" 
       data-controller="notification" 
       data-notification-timeout-value="3000">
    <div class="flex items-center">
      <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
      </svg>
      <%= @task.parent_id.nil? ? "Tarefa removida com sucesso!" : "Subtarefa removida com sucesso!" %>
    </div>
  </div>
<% end %>
